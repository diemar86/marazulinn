{#
  Mini card para carrusel: SOLO imagen + tÃ­tulo + link
  - Evita strip_tags(label) porque label puede ser render array.
  - Usa node.label como string seguro.
#}

{% set title = (node is defined and node) ? node.label : 'Ver' %}
{% set img_url = '' %}
{% set img_alt = title %}

{# Primer item del campo imagen #}
{% if node is defined and node and node.field_imagen is defined and node.field_imagen|length > 0 %}
  {% set item = node.field_imagen.0 %}

  {% if item.entity is not empty and item.entity.uri is not empty %}
    {% set img_url = file_url(item.entity.uri.value) %}
  {% endif %}

  {% if item.alt is not empty %}
    {% set img_alt = item.alt %}
  {% endif %}
{% endif %}

<article{{ attributes.addClass('mz-mini-card') }}>
  <a href="{{ url }}" class="mz-mini-card__link" aria-label="{{ title|e }}">
    {% if img_url %}
      <div class="mz-mini-card__media">
        <img src="{{ img_url }}" alt="{{ img_alt|e }}" loading="lazy">
      </div>
    {% endif %}

    <h3 class="mz-mini-card__title">{{ title }}</h3>
  </a>
</article>
